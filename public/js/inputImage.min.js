$(document).on('click','#close-preview',function(){console.log($(this).attr('id'));$('.image-preview').popover('hide');$('.image-preview').hover(function(){$('.image-preview').popover('show')},function(){$('.image-preview').popover('hide')})});$(function(){var closebtn=$('<button/>',{type:"button",text:'x',id:'close-preview',style:'font-size: initial;',});closebtn.attr("class","close pull-right");$('.image-preview').popover({trigger:'manual',html:!0,title:"<strong>Preview</strong>"+$(closebtn)[0].outerHTML,content:"There's no image",placement:'bottom'});$('.image-preview-clear').click(function(){var id=$(this).attr('id').split('_')[1];$("#group_"+id).attr("data-content","").popover('hide');$("#input_dis_"+id).val("");$("#bouton_"+id).hide();$("input_"+id+" input:file").val("");$("#span_"+id).text("Ouvrir")});$(".image-preview-input input:file").change(function(e){var id=$(this).attr('name').split('_')[0];var img=$('<img/>',{id:'dynamic',width:250,height:200});var file=this.files[0];var reader=new FileReader();reader.onload=function(e){$("#span_"+id).text($('#changer').html());$("#bouton_"+id).show();$("#input_dis_"+id).val(file.name);img.attr('src',e.target.result);$("#group_"+id).attr("data-content",$(img)[0].outerHTML).popover("show")}
reader.readAsDataURL(file)});$('#iconeCreate').on('click',function(e){var file=$('.image-preview-input input:file').val();var extension=file.split('.').pop();var icone_nom=$('input:text').val();var icone=icone_nom.toLowerCase()+'.'+extension;var url=$('#form_icone').attr('action');var url_get=url.replace('laboratoire/icones','api/listeIcones')
$.get({url:url_get,}).done(function(datas){var icones=JSON.parse(datas);if(icones.indexOf(icone)=='-1'){console.log(icones.indexOf(icone));$('#form_icone').submit()}else{$('input:text').focus().val('').attr('placeholder','Le nom "'+icone_nom+'" existe déjà')}}).fail(function(datas){console.log(datas)})})})
